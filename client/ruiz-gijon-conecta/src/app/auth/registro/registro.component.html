<form (ngSubmit)="onSubmit()" class="needs-validation d-flex flex-column flex-grow-1"
  style="min-height: calc(100vh - 210px);" novalidate #registroForm="ngForm">

  <!-- contenido principal -->
  <div class="row mb-3 justify-content-between gap-3 flex-grow-1">

    <!-- caja grande -->
    <section class="col bg-white rounded-1 shadow p-4 d-flex flex-column flex-grow-1">
      <legend class="fw-bold fs-2">Registrarse como antiguo alumno</legend>

      <!-- nombre -->
      <div class="mt-3">
        <label for="input-name" class="form-label text-uppercase text-secondary">Nombre completo</label>
        <input type="text" class="form-control text-secondary" id="input-name" placeholder="Ejemplo: John Doe" required
          [(ngModel)]="name" name="name" />
        <div class="valid-feedback">Correcto</div>
        <div class="invalid-feedback">Debes completar el nombre completo</div>
      </div>

      <!-- título -->
      <div class="mt-3">
          <label for="input-title" class="form-label text-uppercase text-secondary">Título identificativo</label>
          <input type="text" class="form-control text-secondary" id="input-title"
            placeholder="Ejemplo: Técnico en sistemas microinformáticos y redes" required 
            [(ngModel)]="titulo" name="titulo" />
          <div class="valid-feedback">Correcto</div>
          <div class="invalid-feedback">Debes completar el título</div>
        </div>

      <!-- Selección de ciclo -->
      <div class="row mt-3">
        <div class="col-md-6">
          <label for="select_titulo" class="form-label text-uppercase text-secondary">Ciclo y especialidad</label>
          <select id="select_titulo" class="form-select" [(ngModel)]="titulo" name="titulo" required>
            <option [ngValue]="null" disabled selected>Selecciona un título</option>
            <option *ngFor="let titulo of titulosDisponibles" [ngValue]="titulo">
              {{ titulo.tipo | titlecase }} - {{ titulo.nombre }}
            </option>
          </select>
        </div>

        <div class="col-md-3">
          <label for="input_inicio" class="form-label text-uppercase text-secondary">Año inicio</label>
          <input type="text" id="input_inicio" class="form-control" [(ngModel)]="comienzoEstudios"
            name="comienzoEstudios" placeholder="2020" required>
        </div>

        <div class="col-md-3">
          <label for="input_fin" class="form-label text-uppercase text-secondary">Año fin</label>
          <input type="text" id="input_fin" class="form-control" [(ngModel)]="finEstudios" name="finEstudios"
            placeholder="2022" required>
        </div>
      </div>

      <!-- Institución + botón añadir -->
      <div class="row mt-2 align-items-end">
        <div class="col-md-9">
          <label for="input_institucion" class="form-label text-uppercase text-secondary">Institución</label>
          <input type="text" id="input_institucion" class="form-control" [(ngModel)]="empresa" name="empresa"
            placeholder="IES Ejemplo" required>
        </div>
        <div class="col-md-3 d-flex justify-content-end">
          <button type="button" class="btn btn-primary mt-4" (click)="agregarTitulo()">
            <i class="bi bi-plus"></i> Añadir título
          </button>
        </div>
      </div>

      <!-- Lista de títulos añadidos -->
      <div class="row mt-3" *ngIf="titulosSeleccionados.length > 0">
        <div class="col-12">
          <h6 class="form-label text-uppercase text-secondary">Títulos añadidos:</h6>
          <ul class="list-group">
            <li *ngFor="let t of titulosSeleccionados; let i = index"
              class="list-group-item d-flex justify-content-between align-items-center">
              {{ t.titulo.nombre }} ({{ t.titulo.tipo }}) - {{ t.comienzoEstudios }} a {{ t.finEstudios }} - {{
              t.empresa }}
              <button type="button" class="btn btn-sm btn-danger" (click)="eliminarTitulo(i)">
                <i class="bi bi-x-lg"></i>
              </button>
            </li>
          </ul>
        </div>
      </div>


      <!-- experiencia empresas -->
      <div class="row mt-3 align-items-end">
        <div class="col-md-12">
          <label for="input_company" class="form-label text-uppercase text-secondary">(Experiencia) Compañía</label>
          <input type="text" class="form-control" id="input_company" placeholder="Nombre compañía" required
            [(ngModel)]="empresa" name="empresa">
          <div class="valid-feedback">Correcto</div>
          <div class="invalid-feedback">Debes completar el nombre de la compañía</div>
        </div>
      </div>

      <!-- Comienzo, Fin y Botón -->
      <div class="row mt-2">
        <div class="col-4 col-md-2">
          <label for="input_ageStartExp" class="form-label text-uppercase text-secondary">Comienzo</label>
          <input type="text" class="form-control" id="input_ageStartExp" placeholder="2022" required
            [(ngModel)]="comienzoExperiencia" name="comienzoExperiencia">
          <div class="valid-feedback">Correcto</div>
          <div class="invalid-feedback">Obligatorio</div>
        </div>
        <div class="col-4 col-md-2">
          <label for="input_ageFinishExp" class="form-label text-uppercase text-secondary">Fin</label>
          <input type="text" class="form-control" id="input_ageFinishExp" placeholder="2023" required
            [(ngModel)]="finExperiencia" name="finExperiencia">
          <div class="valid-feedback">Correcto</div>
          <div class="invalid-feedback">Obligatorio</div>
        </div>
        <div class="col-4 col-md-2 d-flex justify-content-end align-items-end">
          <button type="button" class="btn btn-primary rounded-1 text-white ms-2 px-3 py-2 shadow-sm">
            <i class="bi bi-plus"></i>
          </button>
        </div>
      </div>

      <!-- situación -->
      <div class="row mt-3">
        <div class="col-md-6">
          <label for="input_status" class="form-label text-uppercase text-secondary">ESTADO</label>
          <select id="input_status" class="form-select text-secondary" [(ngModel)]="situacionLaboral"
            name="situacionLaboral">
            <option value="trabajando">Trabajando</option>
            <option value="buscando">Buscando empleo</option>
            <option value="desempleado">Desempleado</option>
          </select>
        </div>
        <div class="col-md-6">
          <label for="input_date" class="form-label text-uppercase text-secondary">Fecha de nacimiento</label>
          <input type="date" class="form-control" id="input_date" required [(ngModel)]="fechaNacimiento"
            name="fechaNacimiento">
          <div class="valid-feedback">Correcto</div>
          <div class="invalid-feedback">Debes completar la fecha de nacimiento</div>
        </div>
      </div>
    </section>

    <!-- requisitos -->
    <div class="col-lg-4">

      <!-- segunda parte formulario -->
      <div class="row bg-white rounded-1 shadow p-4 px-2">

        <!-- tecnología -->
        <div class="row d-flex align-items-end">
          <div class="col-8 col-md-9">
            <label for="input-tec" class="form-label text-uppercase text-secondary">Tecnologías</label>
            <select id="input-tec" class="form-select text-secondary" required [(ngModel)]="tecnologia"
              name="tecnologia">
              <option value="" selected>Selecciona...</option>
              <option value="JavaScript">JavaScript</option>
              <option value="CSS">CSS</option>
              <option value="PHP">PHP</option>
              <option value="SASS">SASS</option>
              <option value="MYSQL">MYSQL</option>
            </select>
          </div>
          <div class="col d-flex justify-content-end">
            <button type="button" class="btn btn-primary rounded-1 text-white ms-2 px-3 py-2 shadow-sm">
              <i class="bi bi-plus"></i>
            </button>
          </div>
        </div>

        <!-- promoción -->
        <div class="mt-3">
          <label for="input_exp" class="form-label text-uppercase text-secondary">Promoción (IES Ruiz Gijón)</label>
          <input type="text" class="form-control text-secondary" id="input_exp" placeholder="2023 / 2025" required
            [(ngModel)]="promocion" name="promocion" />
          <div class="valid-feedback">Correcto</div>
          <div class="invalid-feedback">Debes completar la promoción en la que estuviste en el centro</div>
        </div>
      </div>

      <!-- imagen -->
      <div class="row bg-white rounded-1 shadow py-4 px-2 mt-3">
        <div class="">
          <label for="input_img" class="form-label text-uppercase text-secondary">Imagen</label>
          <input type="file" class="form-control text-secondary" id="input_img" (change)="onImageChange($event)"
            name="imagen" />
          <div class="valid-feedback">Correcto</div>
          <div class="invalid-feedback">Debes completar la promoción en la que estuviste en el centro</div>
        </div>
      </div>

      <!-- Envío -->
      <div class="row bg-white rounded-1 shadow py-4 px-2 mt-3 align-items-center justify-content-center text-center">
        <div class="col-12 col-sm-6 col-lg-7 mb-3 mb-sm-0">
          <h4 class="fw-bold mb-3">¿Listo para registrarte?</h4>
          <button type="submit" class="btn btn-primary rounded-5 py-1 px-3 shadow-sm">Registrarse</button>
        </div>
        <div class="col-8 col-sm-4 col-lg-5">
          <img src="assets/img/perfil.png" alt="Imagen para envío" class="img-fluid rounded-circle">
        </div>
      </div>
    </div>
  </div>
</form>